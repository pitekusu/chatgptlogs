<!DOCTYPE html>
<html lang='ja'>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/bootstrap.min.css" />
    <script src="js/jquery-3.5.1.min.js"></script>
    <title>ChatGPTブッキー会話記録システム</title>
    <script type="text/javascript">
    $(document).ready(function() {
        // ページ読み込み時に実行したい処理
        var apiurl = "https://v2st81ure8.execute-api.ap-northeast-1.amazonaws.com/default/chatgptlog";

        $.ajax({
                url: apiurl,
                type: 'GET',
                dataType: 'json',
            })
            // Ajaxリクエストが成功した時発動
            .done(function(response) {
                var item = response.Items;
                var table = document.getElementById('chatgptlog');
                for (let i = 0; i < item.length; i++) {
                    var tr = $('<tr></tr>').appendTo(table);
                    $('<td>' + item[i].datetime + '</td>').appendTo(tr);
                    $('<td>' + item[i].username + '</td>').appendTo(tr);
                    $('<td>' + item[i].usermessage + '</td>').appendTo(tr);
                    $('<td>' + item[i].fubukimessage + '</td>').appendTo(tr);
                }

            })
            .fail(function(jqXHR, textStatus, errorThrown) {
                alert('エラーです')
            })
    });
    </script>
</head>

<body>
    <nav class="navbar navbar-inverse">
        <div class="container">
            <div class="navbar-header">
                <p>ChatGPTブッキー会話記録システム</p>
            </div>
        </div>
    </nav>
    <div class="container">
        <div class="card card-primary mb-3">
            <div class="card-header">
                <h5 class="card-title">ブッキー会話記録</h5>
            </div>
            <table class="table table-striped" th:if="${items.size()}">
                <thead>
                    <tr>
                        <th style="width: 10%">日次</th>
                        <th style="width: 10%">ユーザ名</th>
                        <th style="width: 30%">ユーザの質問</th>
                        <th style="width: 50%">ブッキーの答え</th>
                    </tr>
                </thead>
                <tbody id='chatgptlog'>
                </tbody>
            </table>
            <div id ="pagination_content">
                <ul class="pagination">
                    <li id="first">&nbsp;<<&nbsp;</li>
                    <li id="prev">&nbsp;<&nbsp;</li>
                    <li class="count"></li>
                    <li id="next">&nbsp;>&nbsp;</li>
                    <li id="last">&nbsp;>>&nbsp;</li>
                </ul>
            </div>
        </div>
    </div>
</body>

</html>